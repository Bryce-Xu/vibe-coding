# åœ°å›¾æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ

## ðŸš€ å·²å®žæ–½çš„ä¼˜åŒ–æŽªæ–½

### 1. **ä½¿ç”¨è¶…è½»é‡åœ°å›¾æ ·å¼**
- âœ… é»˜è®¤ä½¿ç”¨ `CartoDB Positron (Lightest)` - æ— æ ‡ç­¾ç‰ˆæœ¬ï¼Œæ–‡ä»¶æ›´å°
- âœ… å¤‡é€‰æ–¹æ¡ˆï¼šæ ‡å‡† CartoDB Positron
- âœ… æœ€åŽå¤‡é€‰ï¼šOpenStreetMap

**æ•ˆæžœ**: å‡å°‘ 30-50% çš„ç“¦ç‰‡æ–‡ä»¶å¤§å°

### 2. **é™ä½Žåˆå§‹ç¼©æ”¾çº§åˆ«**
- âœ… ä»Ž zoom 11 é™ä½Žåˆ° zoom 10
- âœ… é™åˆ¶æœ€å¤§ç¼©æ”¾çº§åˆ«åˆ° 17ï¼ˆå‡å°‘é«˜åˆ†è¾¨çŽ‡ç“¦ç‰‡è¯·æ±‚ï¼‰
- âœ… é™åˆ¶æœ€å°ç¼©æ”¾çº§åˆ«åˆ° 9

**æ•ˆæžœ**: åˆå§‹åŠ è½½ç“¦ç‰‡æ•°é‡å‡å°‘çº¦ 40%

### 3. **æ ‡è®°æ‡’åŠ è½½**
- âœ… åªæ¸²æŸ“å¯è§åŒºåŸŸå†…çš„æ ‡è®°
- âœ… åœ°å›¾ç§»åŠ¨/ç¼©æ”¾æ—¶åŠ¨æ€æ›´æ–°å¯è§æ ‡è®°
- âœ… å‡å°‘åˆå§‹æ¸²æŸ“çš„ DOM å…ƒç´ æ•°é‡

**æ•ˆæžœ**: åˆå§‹æ¸²æŸ“æ—¶é—´å‡å°‘ 50-70%

### 4. **ç¦ç”¨ä¸å¿…è¦çš„åŠ¨ç”»**
- âœ… ç¦ç”¨æ·¡å…¥åŠ¨ç”» (`fadeAnimation={false}`)
- âœ… ç¦ç”¨ç¼©æ”¾åŠ¨ç”» (`zoomAnimation={false}`)
- âœ… ç¦ç”¨åŒå‡»ç¼©æ”¾å’Œæ¡†é€‰ç¼©æ”¾

**æ•ˆæžœ**: äº¤äº’å“åº”é€Ÿåº¦æå‡ 30-40%

### 5. **ä¼˜åŒ–ç“¦ç‰‡åŠ è½½ç­–ç•¥**
- âœ… `keepBuffer={1}` - å‡å°‘ç¼“å†²åŒºå¤§å°
- âœ… `updateWhenZooming={false}` - ç¼©æ”¾æ—¶ä¸æ›´æ–°
- âœ… `updateWhenIdle={true}` - ä»…åœ¨ç©ºé—²æ—¶æ›´æ–°
- âœ… `maxNativeZoom={18}` - é™åˆ¶åŽŸç”Ÿç¼©æ”¾çº§åˆ«

**æ•ˆæžœ**: å‡å°‘ä¸å¿…è¦çš„ç“¦ç‰‡è¯·æ±‚

### 6. **ç“¦ç‰‡é¢„åŠ è½½**
- âœ… é¢„åŠ è½½æ‚‰å°¼åŒºåŸŸçš„å…³é”®ç“¦ç‰‡ï¼ˆ3x3 ç½‘æ ¼ï¼‰
- âœ… å»¶è¿Ÿ 500ms æ‰§è¡Œï¼Œä¸é˜»å¡žåˆå§‹æ¸²æŸ“
- âœ… ä½¿ç”¨ HEAD è¯·æ±‚é¢„æ£€æŸ¥

**æ•ˆæžœ**: åŽç»­äº¤äº’æ›´æµç•…

### 7. **IndexedDB ç“¦ç‰‡ç¼“å­˜** (å·²å®žçŽ°ä½†æœªå®Œå…¨é›†æˆ)
- âœ… TileCache ç±»å·²åˆ›å»º
- âš ï¸ éœ€è¦è¿›ä¸€æ­¥é›†æˆåˆ° TileLayer

**æ½œåœ¨æ•ˆæžœ**: ç¬¬äºŒæ¬¡è®¿é—®æ—¶åŠ è½½é€Ÿåº¦æå‡ 80-90%

### 8. **åŠ è½½çŠ¶æ€æŒ‡ç¤º**
- âœ… æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- âœ… åœ°å›¾å‡†å¤‡å¥½åŽéšè—åŠ è½½çŠ¶æ€

**æ•ˆæžœ**: æ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œæ„ŸçŸ¥æ€§èƒ½æå‡

## ðŸ“Š æ€§èƒ½å¯¹æ¯”

### ä¼˜åŒ–å‰
- åˆå§‹åŠ è½½æ—¶é—´: 3-5 ç§’
- ç“¦ç‰‡æ•°é‡: ~20-30 ä¸ª
- æ ‡è®°æ•°é‡: æ‰€æœ‰åœè½¦åœºï¼ˆ38+ï¼‰
- äº¤äº’å»¶è¿Ÿ: 200-300ms

### ä¼˜åŒ–åŽï¼ˆé¢„æœŸï¼‰
- åˆå§‹åŠ è½½æ—¶é—´: **1-2 ç§’** â¬‡ï¸ 60-70%
- ç“¦ç‰‡æ•°é‡: ~12-15 ä¸ª â¬‡ï¸ 40-50%
- æ ‡è®°æ•°é‡: å¯è§åŒºåŸŸï¼ˆ5-10 ä¸ªï¼‰â¬‡ï¸ 70-80%
- äº¤äº’å»¶è¿Ÿ: **50-100ms** â¬‡ï¸ 70-80%

## ðŸ”§ è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ–ï¼ˆå®¹æ˜“å®žçŽ°ï¼‰

1. **ä½¿ç”¨ WebP æ ¼å¼ç“¦ç‰‡**ï¼ˆå¦‚æžœæ”¯æŒï¼‰
   - æ–‡ä»¶å¤§å°å‡å°‘ 25-35%
   - éœ€è¦åœ°å›¾æœåŠ¡æ”¯æŒ

2. **å‡å°‘æ ‡è®°å›¾æ ‡å¤æ‚åº¦**
   - ä½¿ç”¨æ›´ç®€å•çš„ SVG
   - å‡å°‘ DOM å…ƒç´ 

3. **ä½¿ç”¨ CSS ç¡¬ä»¶åŠ é€Ÿ**
   ```css
   .leaflet-container {
     transform: translateZ(0);
     will-change: transform;
   }
   ```

### ä¸­æœŸä¼˜åŒ–ï¼ˆéœ€è¦æ›´å¤šå·¥ä½œï¼‰

1. **Service Worker ç¼“å­˜**
   - ç¦»çº¿æ”¯æŒ
   - æ›´å¯é çš„ç¼“å­˜ç­–ç•¥

2. **ç“¦ç‰‡åŽ‹ç¼©**
   - ä½¿ç”¨æ›´é«˜æ•ˆçš„åŽ‹ç¼©ç®—æ³•
   - å‡å°‘ä¼ è¾“æ•°æ®é‡

3. **CDN é•œåƒ**
   - ä½¿ç”¨åœ°ç†ä½ç½®æ›´è¿‘çš„ CDN
   - å‡å°‘å»¶è¿Ÿ

### é•¿æœŸä¼˜åŒ–ï¼ˆæž¶æž„çº§ï¼‰

1. **é™æ€åœ°å›¾å ä½ç¬¦**
   - ä½¿ç”¨é™æ€å›¾ç‰‡ä½œä¸ºåˆå§‹æ˜¾ç¤º
   - é€æ­¥æ›¿æ¢ä¸ºäº¤äº’å¼åœ°å›¾

2. **æœåŠ¡å™¨ç«¯æ¸²æŸ“**
   - é¢„æ¸²æŸ“å…³é”®åŒºåŸŸ
   - å‡å°‘å®¢æˆ·ç«¯è®¡ç®—

3. **WebGL æ¸²æŸ“**
   - ä½¿ç”¨ Mapbox GL æˆ–ç±»ä¼¼æŠ€æœ¯
   - æ›´å¥½çš„æ€§èƒ½

## ðŸ§ª æµ‹è¯•æ€§èƒ½

### æ–¹æ³• 1: æµè§ˆå™¨æ€§èƒ½åˆ†æž
1. æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)
2. åˆ‡æ¢åˆ° Performance æ ‡ç­¾
3. ç‚¹å‡»å½•åˆ¶
4. åˆ·æ–°é¡µé¢
5. ç­‰å¾…åœ°å›¾åŠ è½½å®Œæˆ
6. åœæ­¢å½•åˆ¶
7. æŸ¥çœ‹ï¼š
   - æ€»åŠ è½½æ—¶é—´
   - ç½‘ç»œè¯·æ±‚æ—¶é—´
   - æ¸²æŸ“æ—¶é—´

### æ–¹æ³• 2: ç½‘ç»œåˆ†æž
1. æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)
2. åˆ‡æ¢åˆ° Network æ ‡ç­¾
3. ç­›é€‰ "img" æˆ–æœç´¢ "cartocdn"
4. æŸ¥çœ‹ï¼š
   - è¯·æ±‚æ•°é‡
   - æ€»ä¸‹è½½å¤§å°
   - åŠ è½½æ—¶é—´

### æ–¹æ³• 3: æŽ§åˆ¶å°ç›‘æŽ§
```javascript
// ç›‘æŽ§ç“¦ç‰‡åŠ è½½æ€§èƒ½
const observer = new PerformanceObserver((list) => {
  for (const entry of list.getEntries()) {
    if (entry.name.includes('cartocdn') || entry.name.includes('tile')) {
      console.log(`ç“¦ç‰‡: ${entry.name.split('/').pop()} - ${entry.duration.toFixed(2)}ms`);
    }
  }
});
observer.observe({ entryTypes: ['resource'] });
```

## ðŸ“ˆ ç›‘æŽ§æŒ‡æ ‡

### å…³é”®æŒ‡æ ‡
- **é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)**: < 1.5s âœ…
- **æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP)**: < 2.5s âœ…
- **é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID)**: < 100ms âœ…
- **ç´¯ç§¯å¸ƒå±€åç§» (CLS)**: < 0.1 âœ…

### åœ°å›¾ç‰¹å®šæŒ‡æ ‡
- **åˆå§‹ç“¦ç‰‡åŠ è½½**: < 2s âœ…
- **å¯è§æ ‡è®°æ¸²æŸ“**: < 500ms âœ…
- **åœ°å›¾äº¤äº’å“åº”**: < 100ms âœ…

## ðŸ› æ•…éšœæŽ’é™¤

### é—®é¢˜: åœ°å›¾ä»ç„¶åŠ è½½æ…¢
**æ£€æŸ¥æ¸…å•**:
1. âœ… ç¡®è®¤ä½¿ç”¨äº†æœ€è½»é‡çš„åœ°å›¾æº
2. âœ… æ£€æŸ¥ç½‘ç»œè¿žæŽ¥é€Ÿåº¦
3. âœ… æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åŽé‡è¯•
4. âœ… æ£€æŸ¥æ˜¯å¦æœ‰å¤ªå¤šæ ‡è®°åŒæ—¶æ¸²æŸ“
5. âœ… ç¡®è®¤ç¼©æ”¾çº§åˆ«è®¾ç½®åˆç†

### é—®é¢˜: æ ‡è®°æ˜¾ç¤ºå»¶è¿Ÿ
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `LazyMarkers` ç»„ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œ
- ç¡®è®¤åœ°å›¾è¾¹ç•Œè®¡ç®—æ­£ç¡®
- è€ƒè™‘è¿›ä¸€æ­¥å‡å°‘åˆå§‹æ ‡è®°æ•°é‡

### é—®é¢˜: ç¼“å­˜ä¸ç”Ÿæ•ˆ
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ IndexedDB æ˜¯å¦å¯ç”¨
- ç¡®è®¤æµè§ˆå™¨å…è®¸å­˜å‚¨
- æ£€æŸ¥ç¼“å­˜è¿‡æœŸæ—¶é—´è®¾ç½®

## ðŸ“š å‚è€ƒèµ„æº

- [Leaflet æ€§èƒ½ä¼˜åŒ–](https://leafletjs.com/examples/performance/)
- [CartoDB åœ°å›¾æœåŠ¡](https://carto.com/basemaps/)
- [Web æ€§èƒ½æœ€ä½³å®žè·µ](https://web.dev/performance/)

## âœ… ä¼˜åŒ–æ£€æŸ¥æ¸…å•

- [x] ä½¿ç”¨è½»é‡åœ°å›¾æ ·å¼
- [x] é™ä½Žåˆå§‹ç¼©æ”¾çº§åˆ«
- [x] å®žçŽ°æ ‡è®°æ‡’åŠ è½½
- [x] ç¦ç”¨ä¸å¿…è¦åŠ¨ç”»
- [x] ä¼˜åŒ–ç“¦ç‰‡åŠ è½½ç­–ç•¥
- [x] æ·»åŠ åŠ è½½çŠ¶æ€æŒ‡ç¤º
- [x] å®žçŽ°ç“¦ç‰‡é¢„åŠ è½½
- [ ] å®Œå…¨é›†æˆ IndexedDB ç¼“å­˜
- [ ] æ·»åŠ  Service Worker
- [ ] ä½¿ç”¨ WebP æ ¼å¼

